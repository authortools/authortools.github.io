<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ—Ç–æ–∫ | –§–∏–Ω–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è</title>

    <!-- ================== PWA –∏ –ú–æ–±–∏–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è: –ù–ê–ß–ê–õ–û ================== -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#007bff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="–ü–æ—Ç–æ–∫">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    <!-- =================== PWA –∏ –ú–æ–±–∏–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è: –ö–û–ù–ï–¶ =================== -->

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –¥–ª—è —Ä–µ–∂–∏–º–æ–≤ –°–ø—Ä–∏–Ω—Ç/–î—Ä–∞–π–≤ -->
    <div id="progress-bar"></div>

    <div class="container" id="app-container">
        <header>
            <h1 data-lang-key="title">–ü–æ—Ç–æ–∫</h1>
            <p data-lang-key="subtitle">–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å, —á—Ç–æ–±—ã –≤–æ–π—Ç–∏ –≤ —Ä–µ–∂–∏–º —Ñ–æ–∫—É—Å–∞.</p>
        </header>

        <main>
            <div id="editor" contenteditable="true" data-lang-key="editor_placeholder" placeholder="–ù–∞—á–Ω–∏—Ç–µ –ø–∏—Å–∞—Ç—å –∑–¥–µ—Å—å..."></div>
            <button id="idea-button" class="btn btn-secondary" title="–ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –∏–¥–µ—é" data-lang-key="btn_idea">–ò–¥–µ—è</button>
            <button id="copy-editor-button" class="btn btn-secondary" title="–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç" data-lang-key="btn_copy">–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
        </main>
        
        <div class="stats-bar">
            <span data-lang-key="stats_chars">–°–∏–º–≤–æ–ª—ã</span>: <span id="char-count">0</span>
            <span data-lang-key="stats_words">–°–ª–æ–≤–∞</span>: <span id="word-count">0</span>
            <span data-lang-key="stats_pages">–°—Ç—Ä–∞–Ω–∏—Ü—ã</span>: <span id="page-count">0</span>
        </div>

        <div class="main-actions-wrapper">
            <div class="settings-container collapsed" id="settings-container">
                <div class="settings-header" id="settings-header">
                    <span data-lang-key="settings_header">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                    <span class="arrow">‚ñº</span>
                </div>
                <div class="controls-wrapper">
                    <!-- –°–µ–∫—Ü–∏—è: –†–µ–∂–∏–º —Å–µ—Å—Å–∏–∏ -->
                    <div class="settings-section">
                        <h5 class="settings-section-title" data-lang-key="group_title_session">–†–µ–∂–∏–º –°–µ—Å—Å–∏–∏</h5>
                        <div class="settings-section-content">
                            <div class="control-group">
                                <label for="mode-select" data-lang-key="label_mode">–†–µ–∂–∏–º</label>
                                <select id="mode-select">
                                    <option value="classic" data-lang-key="option_classic">–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π</option>
                                    <option value="sprint" data-lang-key="option_sprint">–°–ø—Ä–∏–Ω—Ç (–≤—Ä–µ–º—è)</option>
                                    <option value="drive" data-lang-key="option_drive">–î—Ä–∞–π–≤ (–∑–Ω–∞–∫–∏)</option>
                                </select>
                            </div>
                            <div class="control-group hidden" id="sprint-settings">
                                <label for="sprint-duration" data-lang-key="label_sprint_duration">–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–º–∏–Ω)</label>
                                <input type="number" id="sprint-duration" value="25" min="1">
                            </div>
                            <div class="control-group hidden" id="drive-settings">
                                <label for="drive-goal" data-lang-key="label_drive_goal">–¶–µ–ª—å (–∑–Ω–∞–∫–æ–≤)</label>
                                <input type="number" id="drive-goal" value="1800" min="100" step="100">
                            </div>
                            <div class="control-group">
                                <label for="punishment-select" data-lang-key="label_punishment">–ù–∞–∫–∞–∑–∞–Ω–∏–µ</label>
                                <select id="punishment-select">
                                    <option value="delete" data-lang-key="option_delete">–£–¥–∞–ª–µ–Ω–∏–µ</option>
                                    <option value="soft" data-lang-key="option_soft">–ö—Ä–∞—Å–Ω—ã–µ —Å–ª–æ–≤–∞</option>
                                    <option value="shake" data-lang-key="option_shake">–¢—Ä—è—Å–∫–∞</option>
                                    <option value="hardcore" data-lang-key="option_hardcore">–ù–∏ —à–∞–≥—É –Ω–∞–∑–∞–¥</option>
                                    <option value="impossible" data-lang-key="option_impossible">–°—Ç—Ä–∞—Ö –∏ –≥–æ–ª–æ–¥</option>
                                </select>
                            </div>
                            <div class="control-group" id="wait-time-group">
                                <label for="wait-time" data-lang-key="label_wait_time">–û–∂–∏–¥–∞–Ω–∏–µ (—Å–µ–∫)</label>
                                <input type="number" id="wait-time" value="5" min="1">
                            </div>
                            <div class="control-group" id="delete-speed-group">
                                <label for="delete-speed" data-lang-key="label_delete_speed">–°–∫–æ—Ä–æ—Å—Ç—å (–∑–Ω/—Å–µ–∫)</label>
                                <input type="number" id="delete-speed" value="3" min="1">
                            </div>
                        </div>
                    </div>

                    <!-- –°–µ–∫—Ü–∏—è: –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
                    <div class="settings-section">
                        <h5 class="settings-section-title" data-lang-key="group_title_app">–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è</h5>
                        <div class="button-row">
                            <button id="theme-switcher" class="btn btn-secondary" title="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">üåô</button>
                            <button id="language-switcher" class="btn btn-secondary" title="–°–º–µ–Ω–∏—Ç—å —è–∑—ã–∫">üåç</button>
                        </div>
                        <div class="settings-section-content" style="margin-top: 15px;">
                             <div class="control-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="sound-keypress-toggle">
                                    <span data-lang-key="label_sound_keypress">–ó–≤—É–∫ –∫–ª–∞–≤–∏—à</span>
                                </label>
                             </div>
                             <div class="control-group">
                                <label class="checkbox-label">
                                    <input type="checkbox" id="sound-warning-toggle">
                                    <span data-lang-key="label_sound_warning">–ó–≤—É–∫–æ–≤–æ–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ</span>
                                </label>
                             </div>
                        </div>
                    </div>

                    <!-- –°–µ–∫—Ü–∏—è: –ß–µ—Ä–Ω–æ–≤–∏–∫–∏ -->
                    <div class="settings-section">
                         <h5 class="settings-section-title" data-lang-key="group_title_drafts">–ß–µ—Ä–Ω–æ–≤–∏–∫–∏</h5>
                         <div class="button-row">
                            <button id="drafts-button" class="btn btn-secondary" data-lang-key="btn_drafts">–ú–æ–∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∏</button>
                         </div>
                    </div>
                </div>
            </div>
            <button id="save-button" class="btn btn-primary" data-lang-key="btn_save">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
        </div>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–µ—Å—Å–∏–∏ -->
    <button id="stop-session-button" class="btn btn-danger hidden">
        <span class="stop-btn-text" data-lang-key="btn_stop">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</span>
        <span class="stop-btn-icon">‚ñ†</span>
    </button>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: –£—Å–ø–µ—Ö -->
    <div id="success-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 id="success-title"></h2>
            <p id="success-message"></p>
            <button id="close-modal-button" class="btn btn-primary" data-lang-key="btn_modal_continue">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å</button>
        </div>
    </div>
    
    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ: –ß–µ—Ä–Ω–æ–≤–∏–∫–∏ -->
    <div id="drafts-modal" class="modal-overlay hidden">
        <div class="modal-content">
            <h2 data-lang-key="modal_drafts_title">–ú–æ–∏ —á–µ—Ä–Ω–æ–≤–∏–∫–∏</h2>
            <div id="new-draft-controls">
                 <input type="text" id="new-draft-name" placeholder="–ò–º—è –Ω–æ–≤–æ–≥–æ —á–µ—Ä–Ω–æ–≤–∏–∫–∞...">
                 <button id="add-new-draft-button" class="btn btn-secondary" data-lang-key="btn_add_draft">–°–æ–∑–¥–∞—Ç—å</button>
            </div>
            <ul id="drafts-list">
                <!-- –°—é–¥–∞ –±—É–¥—É—Ç –¥–æ–±–∞–≤–ª—è—Ç—å—Å—è —á–µ—Ä–Ω–æ–≤–∏–∫–∏ —á–µ—Ä–µ–∑ JS -->
            </ul>
            <button id="close-drafts-modal-button" class="btn btn-primary" data-lang-key="btn_close_drafts">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <!-- –ê—É–¥–∏–æ—Ñ–∞–π–ª—ã -->
    <audio id="keypress-sound" src="sounds/keypress.mp3" preload="auto"></audio>
    <audio id="warning-sound" src="sounds/warning.mp3" preload="auto"></audio>

    <!-- –°–∫—Ä–∏–ø—Ç—ã -->
    <script src="script.js"></script>
    <script>
      if ('serviceWorker' in navigator) {
        window.addEventListener('load', () => {
          navigator.serviceWorker.register('sw.js')
            .then(registration => {
              console.log('ServiceWorker —É—Å–ø–µ—à–Ω–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω: ', registration.scope);
            })
            .catch(error => {
              console.log('–û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ ServiceWorker: ', error);
            });
        });
      }
    </script>
</body>
</html>
